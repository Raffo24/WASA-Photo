openapi: 3.0.3
info:
  title: WASAPhoto API
  description: API to create a Bearer Authentication Token with OpenAPI 3.0
  version: 1.0.0
tags:
  - name: "API management"
    description: "API management"
  - name: "user management"
    description: "user management"
  - name: "feed stream"
    description: "feed stream"
  - name: user info
    description: user info
  - name: social network
    description: social network
  - name: photos
    description: photos
servers:
  - url: http://localhost:8080
    description: Local Server
paths:
    /:
      get:
        tags:
          - API management
        summary: Get the API status
        description: Get the API status
        operationId: getApiStatus
        responses:
          '200':
            description: OK
            content:
              application/json:
                schema:
                  $ref: '#/components/schemas/ApiStatus'
          '500':
            description: Internal Server Error
            content:
              application/json:
                schema:
                  $ref: '#/components/schemas/Error'
    /session:
      post:
        tags:
          - user management
        summary: Logs in the user
        description: If the user not exist,
          it will be created and
          an identification token will be returned
          if the user exist, the user identifier will be returned
        operationId: doLogin
        requestBody:
          description: User details
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/User"
          required: true
        responses:
          201:
            description: User log-in action successful
            content:
              application/json:
                schema:
                  $ref: "#/components/schemas/Token"
          400:  
            description: Invalid username/password supplied
            content:
              application/json:
                schema:
                  $ref: "#/components/schemas/Error"
          404:
            description: User not found
            content:
              application/json:
                schema:
                  $ref: "#/components/schemas/Error"
          500:
            description: Internal Server Error
            content:
              application/json:
                schema:
                  $ref: "#/components/schemas/Error"
    /feed:
      get:
        tags:
          - feed stream
        summary: Get feed stream
        description: Get the feed stream of the user
        operationId: getMyStream
        security:
          - bearerAuth: []
        responses:
          200:
            description: Successful operation
            content:
              application/json:
                schema:
                  $ref: "#/components/schemas/Photo"
          400:
            description: Invalid User
            content:
              application/json:
                schema:
                  $ref: "#/components/schemas/Error"
          404:
            description: User not found
            content:
              application/json:
                schema:
                  $ref: "#/components/schemas/Error"
          500:
            description: Internal Server Error
            content:
              application/json:
                schema:
                  $ref: "#/components/schemas/Error"
    /users/{id}:
      parameters:
        - name: id
          in: path
          description: id of the user that needs to be fetched
          required: true
          schema:
            type: string
            minLength: 5
            maxLength: 5
            pattern: "[A-Za-z0-9]*"
      get:
        tags:
          - user info
        summary: Get User Profile
        description: Get a user profile
        operationId: getUserProfile
        security:
          - bearerAuth: []
        responses:
          201:
            description: Successful operation
            content:
              application/json:
                schema:
                  $ref: "#/components/schemas/User"
          400:
            description: Invalid id supplied
            content:
              application/json:
                schema:
                  $ref: "#/components/schemas/Error"
          404:
            description: User not found
            content:
              application/json:
                schema:
                  $ref: "#/components/schemas/Error"
          500:
            description: Internal Server Error
            content:
              application/json:
                schema:
                  $ref: "#/components/schemas/Error"
      put:
        tags:
          - user info
        summary: Update Username
        description: Update my username
        operationId: setMyUserName
        requestBody:
          description: Username
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/User"
          required: true
        security:
          - bearerAuth: []
        responses:
          201:
            description: Successful operation
            content:
              application/json:
                schema:
                  $ref: "#/components/schemas/User"
          400:
            description: Invalid id supplied
            content:
              application/json:
                schema:
                  $ref: "#/components/schemas/Error"
          404:
            description: User not found
            content:
              application/json:
                schema:
                  $ref: "#/components/schemas/Error"
          500:
            description: Internal Server Error
            content:
              application/json:
                schema:
                  $ref: "#/components/schemas/Error"
    /users/{id}/follow/{followId}:
      parameters:
        - name: id
          in: path
          description: id of the user that needs to be followed
          required: true
          schema:
            type: string
            pattern: "[A-Za-z0-9]*"
            minLength: 5
            maxLength: 5
        - name: followId
          in: path
          description: id of the user that needs to be followed
          required: true
          schema:
            type: string
            pattern: "[A-Za-z0-9]*"
            minLength: 5
            maxLength: 5
      put:
        tags:
          - social network
        summary: Follow User
        description: Follow a user
        operationId: followUser
        security:
          - bearerAuth: []
        responses:
          201:
            description: Successful operation
            content:
              application/json:
                schema:
                  $ref: "#/components/schemas/User"
          400:
            description: Invalid id supplied
            content:
              application/json:
                schema:
                  $ref: "#/components/schemas/Error"
          404:
            description: User not found
            content:
              application/json:
                schema:
                  $ref: "#/components/schemas/Error"
          500:
            description: Internal Server Error
            content:
              application/json:
                schema:
                  $ref: "#/components/schemas/Error"
      delete:
        tags:
          - social network
        summary: Unfollow User
        description: Unfollow a user
        operationId: unfollowUser
        security:
          - bearerAuth: []
        responses:
          200:
            description: Successful operation
            content:
              application/json:
                schema:
                  $ref: "#/components/schemas/User"
          400:
            description: Invalid id supplied
            content:
              application/json:
                schema:
                  $ref: "#/components/schemas/Error"
          404:
            description: User not found
            content:
              application/json:
                schema:
                  $ref: "#/components/schemas/Error"
          500:
            description: Internal Server Error
            content:
              application/json:
                schema:
                  $ref: "#/components/schemas/Error"
    /users/{id}/ban/{banId}:
      parameters:
        - name: id
          in: path
          description: id that wants to ban another user
          required: true
          schema:
            type: string
            pattern: "[A-Za-z0-9]*"
            minLength: 5
            maxLength: 5
        - name: banId
          in: path
          description: id of the user that needs to be banned
          required: true
          schema:
            type: string
            pattern: "[A-Za-z0-9]*"
            minLength: 5
            maxLength: 5
      post:
        tags:
          - social network
        summary: Ban User
        description: Ban a user
        operationId: banUser
        security:
          - bearerAuth: []
        responses:
          201:
            description: Successful operation
            content:
              application/json:
                schema:
                  $ref: "#/components/schemas/User"
          400:
            description: Invalid id supplied
            content:
              application/json:
                schema:
                  $ref: "#/components/schemas/Error"
          404:
            description: User not found
            content:
              application/json:
                schema:
                  $ref: "#/components/schemas/Error"
          500:
            description: Internal Server Error
            content:
              application/json:
                schema:
                  $ref: "#/components/schemas/Error"
      delete:
        tags:
          - social network 
        summary: Unban User
        description: Unban a user
        operationId: unbanUser
        security:
          - bearerAuth: []
        responses:
          200:
            description: Successful operation
            content:
              application/json:
                schema:
                  $ref: "#/components/schemas/User"
          400:
            description: Invalid id supplied
            content:
              application/json:
                schema:
                  $ref: "#/components/schemas/Error"
          404:
            description: User not found
            content:
              application/json:
                schema:
                  $ref: "#/components/schemas/Error"
          500:
            description: Internal Server Error
            content:
              application/json:
                schema:
                  $ref: "#/components/schemas/Error"
    /users/{id}/photos:
      parameters:
        - name: id
          in: path
          description: id of the user that needs to be fetched
          required: true
          schema:
            type: string
            pattern: "[A-Za-z0-9]*"
            minLength: 5
            maxLength: 5
      get:
        tags:
          - user info
        summary: Get User Photos
        description: Get a user photos
        operationId: getUserPhotos
        security:
          - bearerAuth: []
        responses:
          200:
            description: Successful operation
            content:
              application/json:
                schema:
                  $ref: "#/components/schemas/Photo"
          400:
            description: Invalid id supplied
            content:
              application/json:
                schema:
                  $ref: "#/components/schemas/Error"
          404:
            description: User not found
            content:
              application/json:
                schema:
                  $ref: "#/components/schemas/Error"
          500:
            description: Internal Server Error
            content:
              application/json:
                schema:
                  $ref: "#/components/schemas/Error"
    /users/{username}/search:
      get:
        tags:
          - user management
        summary: Search User
        description: Search a user by username
        operationId: getMyUserName
        parameters:
          - name: username
            in: path
            description: username of the user that needs to be fetched
            required: true
            schema:
              type: string
              pattern: "[A-Za-z0-9]*"
              minLength: 5
              maxLength: 5
        responses:
          200:
            description: Successful operation
            content:
              application/json:
                schema:
                  $ref: "#/components/schemas/User"
          400:
            description: Invalid username supplied
            content:
              application/json:
                schema:
                  $ref: "#/components/schemas/Error"
          404:
            description: User not found
            content:
              application/json:
                schema:
                  $ref: "#/components/schemas/Error"
          500:
            description: Internal Server Error
            content:
              application/json:
                schema:
                  $ref: "#/components/schemas/Error"
    /photos:
      post:
        tags:
          - photos
        summary: Upload Photo
        description: Upload a new photo
        operationId: uploadPhoto
        requestBody:
          content:
            multipart/form-data:
              schema:
                $ref: "#/components/schemas/Photo"
          required: true
        security:
          - bearerAuth: []
        responses:
          201:
            description: Successful operation
            content:
              application/json:
                schema:
                  $ref: "#/components/schemas/Photo"
          400:
            description: Invalid photo
            content:
              application/json:
                schema:
                  $ref: "#/components/schemas/Error"
          500:
            description: Internal Server Error
            content:
              application/json:
                schema:
                  $ref: "#/components/schemas/Error"

    /photos/{id}:
      parameters:
        - name: id
          in: path
          description: ID of the photo that needs to be fetched
          required: true
          schema:
            type: string
            pattern: "[A-Za-z0-9]*"
            minLength: 5
            maxLength: 5
      get:
        tags:
            - photos
        summary: Get Photo
        description: Get a photo
        operationId: getPhoto
        
        security:
          - bearerAuth: []
        responses:
          200:
            description: image in PNG format
            content:
              image/png:
                schema:
                  type: string
                  format: binary
                  description: image in PNG format
          400:
            description: Invalid photo ID supplied
            content:
              application/json:
                schema:
                  $ref: "#/components/schemas/Error"
          404:
            description: Photo not found
            content:
              application/json:
                schema:
                  $ref: "#/components/schemas/Error"
          500:
            description: Internal Server Error
            content:
              application/json:
                schema:
                  $ref: "#/components/schemas/Error"
      delete:
        tags:
          - photos
        summary: Delete Photo
        description: Delete a photo
        operationId: deletePhoto
        security:
          - bearerAuth: []
        responses:
          200:
            description: Successful operation
            content:
              application/json:
                schema:
                  $ref: "#/components/schemas/Photo"
          400:
            description: Invalid photo ID supplied
            content:
              application/json:
                schema:
                  $ref: "#/components/schemas/Error"
          404:
            description: Photo not found
            content:
              application/json:
                schema:
                  $ref: "#/components/schemas/Error"
          500:
            description: Internal Server Error
            content:
              application/json:
                schema:
                  $ref: "#/components/schemas/Error"
    /photos/{id}/like/{userId}:
      parameters:
        - name: id
          in: path
          description: ID of the photo that needs to be liked
          schema:
            type: string
            pattern: "[A-Za-z0-9]*"
            minLength: 5
            maxLength: 5
          required: true
        - name: userId
          in: path
          description: ID of the user that needs to like the photo
          schema:
            type: string
            pattern: "[A-Za-z0-9]*"
            minLength: 5
            maxLength: 5
          required: true
      post:
        tags:
          - photos
        summary: Like Photo
        description: Like a photo
        operationId: likePhoto
        security:
          - bearerAuth: []
        responses:
          201:
            description: Successful operation
            content:
              application/json:
                schema:
                  $ref: "#/components/schemas/Photo"
          400:
            description: Invalid photo id supplied
            content:
              application/json:
                schema:
                  $ref: "#/components/schemas/Error"
          404:
            description: Photo not found
            content:
              application/json:
                schema:
                  $ref: "#/components/schemas/Error"
          500:
            description: Internal Server Error
            content:
              application/json:
                schema:
                  $ref: "#/components/schemas/Error"
      delete:
        tags:
          - photos
        summary: Unlike Photo
        description: Unlike a photo
        operationId: unlikePhoto
        security:
          - bearerAuth: []
        responses:
          200:
            description: Successful operation
            content:
              application/json:
                schema:
                  $ref: "#/components/schemas/Photo"
          400:
            description: Invalid photo id supplied
            content:
              application/json:
                schema:
                  $ref: "#/components/schemas/Error"
          404:
            description: Photo not found
            content:
              application/json:
                schema:
                  $ref: "#/components/schemas/Error"
          500:
            description: Internal Server Error
            content:
              application/json:
                schema:
                  $ref: "#/components/schemas/Error"
    /photos/{id}/comments:
      parameters:
        - name: id
          in: path
          description: id of the photo that needs to be fetched
          required: true
          schema:
            type: string
            pattern: "[A-Za-z0-9]*"
            minLength: 5
            maxLength: 5
      get:
        tags:
          - photos
        summary: Get Photo Comments
        description: Get comments for a photo
        operationId: getPhotoComments
        security:
          - bearerAuth: []
        responses:
          200:
            description: Successful operation
            content:
              application/json:
                schema:
                  $ref: "#/components/schemas/Comment"
          400:
            description: Invalid photo id or comment supplied
            content:
              application/json:
                schema:
                  $ref: "#/components/schemas/Error"
          404:
            description: Photo or comment not found
            content:
              application/json:
                schema:
                  $ref: "#/components/schemas/Error"
          500:
            description: Internal Server Error
            content:
              application/json:
                schema:
                  $ref: "#/components/schemas/Error"
      post:
        tags:
          - photos
        summary: Post Photo Comment
        description: Post a comment for a photo
        operationId: commentPhoto
        requestBody:
          required: true
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Comment"
        security:
          - bearerAuth: []
        responses:
          201:
            description: Successful operation
            content:
              application/json:
                schema:
                  $ref: "#/components/schemas/Comment"
          400:
            description: Invalid photo id supplied
            content:
              application/json:
                schema:
                  $ref: "#/components/schemas/Error"
          404:
            description: Photo not found
            content:
              application/json:
                schema:
                  $ref: "#/components/schemas/Error"
          500:
            description: Internal Server Error
            content:
              application/json:
                schema:
                  $ref: "#/components/schemas/Error"
    /comments/{commentId}:
      parameters:
        - name: photoId
          in: path
          description: id of the photo that needs to be fetched
          required: true
          schema:
            type: string
            pattern: "[A-Za-z0-9]*"
            minLength: 5
            maxLength: 5
        - name: commentId
          in: path
          description: id of the comment that needs to be fetched
          required: true
          schema:
            type: string
            pattern: "[A-Za-z0-9]*"
            minLength: 5
            maxLength: 5
      get:
        tags:
          - photos
        summary: Get Photo Comment
        description: Get a comment for a photo
        operationId: getPhotoComment
        security:
          - bearerAuth: []
        responses:
          200:
            description: Successful operation
            content:
              application/json:
                schema:
                  $ref: "#/components/schemas/Comment"
          400:
            description: Invalid photo id supplied
            content:
              application/json:
                schema:
                  $ref: "#/components/schemas/Error"
          404:
            description: Photo not found
            content:
              application/json:
                schema:
                  $ref: "#/components/schemas/Error"
          500:
            description: Internal Server Error
            content:
              application/json:
                schema:
                  $ref: "#/components/schemas/Error"
      delete:
        tags:
          - photos
        summary: Delete Photo Comment
        description: Delete a comment for a photo
        operationId: uncommentPhoto
        security:
          - bearerAuth: []
        responses:
          200:
            description: Successful operation
            content:
              application/json:
                schema:
                  $ref: "#/components/schemas/Comment"
          400:
            description: Invalid photoId or commentId supplied
            content:
              application/json:
                schema:
                  $ref: "#/components/schemas/Error"
          404:
            description: Photo or comment not found
            content:
              application/json:
                schema:
                  $ref: "#/components/schemas/Error"
          500:
            description: Internal Server Error
            content:
              application/json:
                schema:
                  $ref: "#/components/schemas/Error"
components:
  securitySchemes:
      bearerAuth:
        type: http
        scheme: bearer
        bearerFormat: integer
  schemas:
    ApiStatus:
      description: API Status
      type: object
      properties:
        status:
          description: API Status
          type: string
          pattern : ".*"
          minLength: 1
          maxLength: 40
          example: "API is up and running"
      example:
        status: "API is up and running"
    Photo:
      type: object
      description: photo object
      properties:
        id:
          type: string
          pattern: "[A-Za-z0-9]*"
          minLength: 5
          maxLength: 5
          description: ID of the photo
          example: "12131"
        title:
          type: string
          pattern: ".*"
          minLength: 1
          maxLength: 40
          description: Title of the photo
          example: "The photo title"
        description:
          type: string
          pattern: ".*"
          minLength: 0
          maxLength: 300
          description: Description of the photo
          example: "The photo description"
      example:
        id: "12345"
        title: "The photo title"
        description: "The photo description"
    Comment:
      type: object
      description: comment of the photo
      properties:
        id:
          type: string
          pattern: "[A-Za-z0-9]*"
          minLength: 5
          maxLength: 5
          description: ID of the comment
          example: "13123"
        text:
          type: string
          pattern: ".*"
          minLength: 1
          maxLength: 300
          description: Text of the comment
          example: "The comment text"
      example:
        id: "12345"
        text: "The comment text"
    User:
      description: user data
      type: object
      properties:
        id:
          type: string
          pattern: "[A-Za-z0-9]*"
          minLength: 5
          maxLength: 5
          description: ID of the user
          example: "32112"
        username:
          type: string
          pattern: "[A-Za-z0-9]*"
          description: Username of the user
          example: "Maria"
          minLength: 3
          maxLength: 20
      example:
        User:
          value:
            id: "12345"
            username: "Maria"
    Token:
      description: Token data
      type: object
      properties:
        token:
          type: string
          pattern: "[A-Za-z0-9]*"
          description: Token of the user
          example: "3211232321"
          minLength: 3
          maxLength: 20
      example:
        Token:
          value: "12345wew"
    Error:
      description: Error data
      type: object
      properties:
        trace:
          type: string
          pattern: ".*"
          description: Error trace
          example: "Invalid photo id supplied"
          minLength: 1
          maxLength: 300
        errors:
          description: Error messages
          type: array
          minItems: 0
          maxItems: 10
          items:
            $ref: "#/components/schemas/ErrorItem"
      example:
        Error:
          value:
            trace: "Invalid photo id supplied"
            errors:
              - code: 400
                message: "Invalid photo id supplied"
    ErrorItem:
      description: Error item data
      type: object
      properties:
        more_info:
          type: string
          pattern: ".*"
          description: More info about the error
          example: "More info about the error"
          minLength: 1
          maxLength: 100
        code:
          type: string
          description: Error code
          example: "400"
          enum:
            - "400"
            - "401"
            - "403"
            - "404"
            - "500"
        message:
          type: string
          pattern: ".*"
          description: Error message
          example: "Invalid photo id supplied"
          minLength: 1
          maxLength: 40
      example:
        ErrorItem:
          value:
            more_info: "More info about the error"
            code: "400"
            message: "Invalid photo id supplied"